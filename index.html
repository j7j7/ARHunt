<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ARHunt (MindAR)</title>
  <link rel="stylesheet" href="./styles.css" />
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <!-- MindAR for A-Frame -->
  <script src="https://cdn.jsdelivr.net/npm/mind-ar/dist/mindar-image-aframe.prod.js"></script>
</head>
<body>
  <!-- Start Menu -->
  <div id="menu" class="overlay">
    <div class="panel">
      <h1>ARHunt</h1>
      <p>Find the prepared picture frames in your room. Move your phone to scan!</p>
      <button id="startBtn" class="btn primary">Start</button>
    </div>
  </div>

  <!-- HUD -->
  <div id="hud" class="overlay hidden">
    <div class="hud-bar">
      <div class="stats">Found <span id="foundCount">0</span>/<span id="totalCount">8</span></div>
      <button id="quitBtn" class="btn ghost">Quit</button>
    </div>
    <div id="foundText" class="found-text"></div>
  </div>

  <!-- Fireworks Effect -->
  <div id="fireworks" class="fireworks-container hidden"></div>

  <!-- Countdown -->
  <div id="countdown" class="overlay hidden">
    <div class="countdown-container">
      <div class="countdown-timer">5</div>
    </div>
  </div>

  <!-- Congratulations -->
  <div id="congrats" class="overlay hidden">
    <div class="panel">
      <h2>Congratulations!</h2>
      <canvas id="qrCodeCanvas"></canvas>
      <p>You found them all! Please take a screenshot of this QR code for your record.</p>
      <button id="restartBtn" class="btn primary">Play Again</button>
    </div>
  </div>

  <!-- AR Scene (MindAR) -->
  <div id="ar-container">
    <a-scene
      mindar-image="imageTargetSrc: assets/targets/compiled/targets.mind; filterMinCF: 0.001; filterBeta: 0.01; maxTrack: 1; uiLoading: false; uiScanning: false; uiError: false;"
      embedded
      loading-screen="enabled: false"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false">

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <!-- Preload sample overlays -->
      <a-assets>
        <img id="da1" src="assets/overlays/DA1.jpg" />
        <img id="da2" src="assets/overlays/DA2.jpg" />
        <img id="da3" src="assets/overlays/DA3.jpg" />
        <img id="da4" src="assets/overlays/DA4.jpg" />
        <img id="da5" src="assets/overlays/DA5.jpg" />
        <img id="da6" src="assets/overlays/DA6.jpg" />
        <img id="da7" src="assets/overlays/DA7.jpg" />
        <img id="da8" src="assets/overlays/DA8.jpg" />
      </a-assets>

      <!-- 8 possible targets -->
      <a-entity id="target-0" mindar-image-target="targetIndex: 0">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da1; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>
      <a-entity id="target-1" mindar-image-target="targetIndex: 1">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da2; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>
      <a-entity id="target-2" mindar-image-target="targetIndex: 2">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da3; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>
      <a-entity id="target-3" mindar-image-target="targetIndex: 3">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da4; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>
      <a-entity id="target-4" mindar-image-target="targetIndex: 4">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da5; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>
      <a-entity id="target-5" mindar-image-target="targetIndex: 5">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da6; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>
      <a-entity id="target-6" mindar-image-target="targetIndex: 6">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da7; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>
      <a-entity id="target-7" mindar-image-target="targetIndex: 7">
        <a-plane class="overlay-plane" position="0 0 0" rotation="0 0 0" width="1.5" height="0.84" material="src: #da8; transparent: true;" scale="1.5 1.5 1.5"></a-plane>
      </a-entity>

    </a-scene>
  </div>

  <script src="./mind-hunt.js"></script>
</body>
</html>